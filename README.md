
<h2 align="center">ТЕМА 3: Peer-to-peer file exchange (torrent сървър)</h2>

Да се имплементира опростен вариант на peer-to-peer система за обмен на файлове, която използва централен сървър за откриване на потребители и данни. Системата трябва да се състои от две части:

<ol>
 <li>Сървър, който съхранява метаданни за наличните файлове.</li>
 <li>Клиенти, които теглят файлове от други клиенти – клиентите взимат информация от сървъра за това къде (от кой клиент) даден файл може да бъде свален.</li> 
</ol>

Системата предоставя функционалност за сваляне на файлове от различни потребители. Всеки потребител може да сваля файл от всеки друг. Има централен сървър, който съхранява информация за потребителите и файловете, които могат да бъдат свалени от тях (файлове не се свалят и съхраняват на централния сървър). 

Сървърът трябва да може да работи с много клиенти едновременно. Сървърът съхранява информация за активните потребители в паметта (изберете подходяща структура от данни) – имената, адресите и портовете им (p2p обмен изисква да се знаят адресите на peer-ите); файловете, които могат да бъдат изтеглени от тях (абсолютен път). Тази информация се обновява, когато клиент регистрира файлове за изтегляне (команда register по-долу) и когато клиент затвори връзката със сървъра. 

Клиентите могат да се свързват един с друг (peer-to-peer communication). За целта е нужно всеки да реализира „мини сървър“ при себе си. Този мини-сървър трябва да може да обработва командата download, описана по-долу. Можете да изберете дали мини- сървърът да обработва само една заявка за изтегляне или много паралелни заявки (ако е една - докато тя бива обработвана, оставащите заявки за изтегляне към мини-сървъра трябва да чакат). 

Клиентът също така съхранява при себе си съответствие <username-user IP:port>

Пример: 

     Pesho123 – 127.0.0.1:1234 
     Gosho321 – 127.0.0.1:2314 

За да получи клиентът тази информация, той регулярно (през 30 секунди) пита сървъра за регистрираните потребители и техните адреси. Данните се записват във файл в указния по-горе формат. 

Клиентът изпълнява следните команди: 

<ol>
 <li>register <user> <file1, file2, file3, …, fileN> - позволява на клиентите да „обявят“ кои файлове са налични за сваляне от тях. Чрез параметъра username, потребителят може да зададе свое уникално име (името, с което сървърът ще асоциира съответното IP).</li>

 <li>unregister <user> <file1, file2, file3, ... , fileN> - потребителят обявява, че от него вече не могат да се свалят файловете <file1, file2, file3, …, fileN>.</li> 

<p>Забележка: За простота, не се интересуваме от security аспектите на решението, т.е. не е нужно да реализирате автентикация, която да гарантира, че даден потребител може да отрегистрира само файловете, които самият той е регистрирал.</p>

 <li>list-files – връща файловете, налични за изтегляне, и потребителите, от които могат да бъдат изтеглени.</li> 
 <li>download <user> <path to file on user> - изтегля дадения файл от съответния потребител.</li>
</ol>
 
Сървърът трябва да може да обработва изброените команди по подходящ начин: 

<ol>
 <li>При получаване на register <user1> <file1, file2, file3, …, fileN>xсървърът обновява информацията за този потребител (добавя информация, че тези файлове са налични за сваляне от съответния потребител).</li>
  
 <li>При получаване на unregister <user> <file1, file2, file3, ... , fileN> обновява информацията за този потребител (съответните файлове вече не са налични за сваляне от този потребител).</li>
 
 <li>При получаване на list-files, връща регистрираните в сървъра файлове във формат <user> : <path to file> </li>
 <li>При изпълняването на download <user> <path to file on user> <path to save>, не се случва комуникация с централния сървър.
  <ol type="a">
    <li>Клиентът определя IP адреса и порта на потребителя, от който може да бъде изтеглен даденият файл (от локалния си mapping).</li>
    <li>Клиентът изпраща командата на мини-сървъра на потребителя, определен в стъпка (а)</ li>
    <li>Мини-сървърът изпраща файла</li>
    <li>След като потребителят получи файла, автоматично изпълнява командата register <user> <path to saved file>. По този начин информацията в главния сървър за потребителите, притежаващи този файл, се обновява.</li>
  </ol>
</ol>


Една подсказваща диаграма:
<img src="https://github.com/biskvitka/TorrentServer/edit/master/img.png">


